# 商店功能使用指南

## 概述

商店功能允许用户从官方或自定义源获取和安装主题、壁纸源和插件。

## 访问商店

在主界面的导航栏中，点击"商店"图标即可进入商店页面。

## 浏览资源

商店页面分为三个标签：

### 主题标签
展示可用的界面主题资源。

### 壁纸源标签
展示可用的壁纸源（LTWS格式）。

### 插件标签
展示可用的功能插件。

## 查看资源详情

点击资源卡片上的"查看详情"按钮，可以查看：
- 资源名称和版本
- 作者信息
- 详细描述（支持Markdown）
- 许可证信息
- 官方网站、源码仓库等链接

## 安装资源

在资源详情对话框中，点击"安装"按钮即可下载并安装该资源。

### 安装状态

安装过程中会显示提示消息：
- "开始下载..."：开始下载资源
- "下载完成"：下载成功
- "安装成功"：安装完成（壁纸源）
- "安装失败"：出现错误

### 壁纸源安装

壁纸源安装完成后：
1. 会自动导入到系统中
2. 在"资源"页面的壁纸源列表中显示
3. 可以在设置中管理启用/禁用状态

### 主题和插件安装

主题和插件下载后会保存到缓存目录，具体安装步骤：
- **主题**：下载完成后需要手动应用（功能开发中）
- **插件**：下载完成后需要重启应用加载（功能开发中）

## 配置商店源

### 默认官方源

```
https://wallpaper.api.zsxiaoshu.cn
```

### 使用自定义源

1. 进入"设置" → "资源"标签
2. 找到"商店源"设置区域
3. 启用"使用自定义源"开关
4. 输入自定义源URL
5. 重新打开商店页面生效

### 重置为官方源

在商店源设置区域，点击"重置为官方源"按钮。

## 搜索和筛选

（功能待实现）

## 故障排查

### 无法加载资源列表

**可能原因：**
- 网络连接问题
- 商店源URL不正确
- 服务器暂时不可用

**解决方法：**
1. 检查网络连接
2. 在设置中验证商店源URL
3. 尝试重置为官方源
4. 稍后重试

### 下载失败

**可能原因：**
- 网络中断
- 磁盘空间不足
- 资源已被移除

**解决方法：**
1. 检查网络连接
2. 确保有足够的磁盘空间（至少100MB）
3. 重试下载
4. 联系资源作者确认资源可用性

### 安装失败

**壁纸源安装失败：**
- 确保文件格式为 `.ltws`
- 检查壁纸源是否符合协议v3.0规范
- 查看错误提示了解具体原因

**主题/插件安装：**
- 当前版本的主题和插件安装功能仍在开发中
- 下载的文件保存在缓存目录，可手动处理

## 开发者信息

### 创建自定义商店源

如果你想创建自己的商店源服务器，需要提供以下API：

#### 目录结构
```
base_url/
├── theme/
│   ├── index.json
│   └── *.toml
├── resources/
│   ├── index.json
│   └── *.toml
└── plugins/
    ├── index.json
    └── *.toml
```

#### index.json 格式
返回TOML文件名数组：
```json
["resource1.toml", "resource2.toml"]
```

#### TOML元数据格式
参见项目中的资源元数据规范文档。

### API要求

- 支持HTTPS（推荐）
- 响应头设置正确的 `Content-Type`
- 支持CORS（如果需要浏览器访问）

## 更新日志

### v0.1.0 (2025-12-17)
- ✅ 初始版本发布
- ✅ 支持浏览主题、壁纸源、插件
- ✅ 支持查看资源详情
- ✅ 支持壁纸源下载和安装
- ✅ 支持自定义商店源
- 🚧 主题和插件安装功能开发中

## 相关链接

- [插件开发文档](plugin_dev.md)
- [主题开发文档](themes.md)
- [设置说明](settings.md)
